{
  "tags": [
    "user",
    "access_control",
    "safe"
  ],
  "summary": "Lists access control information of the user",
  "description": "Retrieves current permission set, active permission set grant and permissions of the user.",
  "operationId": "listUserPermissions",
  "parameters": [
    {
      "name": "id",
      "in": "path",
      "required": true,
      "description": "Identifier of the platform user.",
      "type": "integer",
      "format": "int64"
    }
  ],
  "responses": {
    "200": {
      "schema": {
        "type": "object",
        "properties": {
          "grant": {
            "type": "object",
            "properties": {
              "id": {
                "type": "integer",
                "format": "int64",
                "description": "Identifier of the permission set grant."
              },
              "permission_set": {
                "type": "object",
                "properties": {
                  "id": {
                    "type": "integer",
                    "format": "int64",
                    "description": "Identifier of the permission set."
                  },
                  "name": {
                    "type": "string",
                    "description": "Name of the permission set."
                  },
                  "description": {
                    "type": "string",
                    "description": "Description of the permission set."
                  },
                  "owner": {
                    "type": "object",
                    "properties": {
                      "id": {
                        "type": "integer",
                        "format": "int64",
                        "description": "Identifier of the platform user."
                      },
                      "username": {
                        "type": "string",
                        "description": "Username of the user."
                      },
                      "inserted_at": {
                        "type": "string",
                        "description": "Registration date of the user in ISO 8601 format."
                      }
                    },
                    "description": "Owner of the permission set."
                  },
                  "permissions": {
                    "type": "array",
                    "items": {
                      "type": "object",
                      "properties": {
                        "id": {
                          "type": "integer",
                          "format": "int64",
                          "description": "Identifier of the permission."
                        },

                        "controller_name": {
                          "type": "string",
                          "description": "Name of the permission controller.",
                          "enum": ["index", "show", "create", "update", "delete"]
                        },

                        "controller_action": {
                          "type": "string",
                          "description": "Affected action of the permission controller.",
                          "enum": ["secure", "mediocre", "severe"]
                        },

                        "severity": {
                          "type": "string",
                          "description": "Severity of the action.",
                          "enum": ["secure", "mediocre", "severe"]
                        }
                      }
                    }
                  },
                  "inserted_at": {
                    "schema": {
                      "$ref": "#/definitions/Timestamp"
                    },
                    "description": "The date permission set created."
                  }
                },
                "description": "Granted permission set."
              },
              "authority": {
                "type": "object",
                "properties": {
                  "id": {
                    "type": "integer",
                    "format": "int64",
                    "description": "Identifier of the platform user."
                  },
                  "username": {
                    "type": "string",
                    "description": "Username of the user."
                  },
                  "inserted_at": {
                    "type": "string",
                    "description": "Registration date of the user in ISO 8601 format."
                  }
                },
                "description": "The authority made the grant."
              },
              "valid_after": {
                "$ref": "#/definitions/Timestamp",
                "description": "The timestamp the grant will be valid after."
              },
              "valid_until": {
                "$ref": "#/definitions/Timestamp",
                "description": "The timestamp the grant will be valid until."
              },
              "inserted_at": {
                "$ref": "#/definitions/Timestamp",
                "description": "The time the grant was created."
              }
            }
          }
        }
      },
      "description": "Response body contains permission set, grant and permissions information."
    }
  }
}
